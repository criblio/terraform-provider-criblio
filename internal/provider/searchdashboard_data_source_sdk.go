// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package provider

import (
	"context"
	"encoding/json"
	tfTypes "github.com/criblio/terraform-provider-criblio/internal/provider/types"
	"github.com/criblio/terraform-provider-criblio/internal/sdk/models/operations"
	"github.com/criblio/terraform-provider-criblio/internal/sdk/models/shared"
	"github.com/hashicorp/terraform-plugin-framework-jsontypes/jsontypes"
	"github.com/hashicorp/terraform-plugin-framework/diag"
	"github.com/hashicorp/terraform-plugin-framework/types"
)

func (r *SearchDashboardDataSourceModel) RefreshFromOperationsGetSearchDashboardByIDResponseBody(ctx context.Context, resp *operations.GetSearchDashboardByIDResponseBody) diag.Diagnostics {
	var diags diag.Diagnostics

	if resp != nil {
		if len(resp.Items) == 0 {
			diags.AddError("Unexpected response from API", "Missing response body array data.")
			return diags
		}

		diags.Append(r.RefreshFromSharedSearchDashboard(ctx, &resp.Items[0])...)

		if diags.HasError() {
			return diags
		}

	}

	return diags
}

func (r *SearchDashboardDataSourceModel) RefreshFromSharedSearchDashboard(ctx context.Context, resp *shared.SearchDashboard) diag.Diagnostics {
	var diags diag.Diagnostics

	r.CacheTTLSeconds = types.Float64PointerValue(resp.CacheTTLSeconds)
	r.Category = types.StringPointerValue(resp.Category)
	r.Description = types.StringPointerValue(resp.Description)
	r.Elements = []tfTypes.DashboardElementUnion{}

	for _, elementsItem := range resp.Elements {
		var elements tfTypes.DashboardElementUnion

		if elementsItem.DashboardElementVisualization != nil {
			elements.DashboardElementVisualization = &tfTypes.DashboardElementVisualization{}
			if len(elementsItem.DashboardElementVisualization.Config) > 0 {
				elements.DashboardElementVisualization.Config = make(map[string]jsontypes.Normalized, len(elementsItem.DashboardElementVisualization.Config))
				for key, value := range elementsItem.DashboardElementVisualization.Config {
					result, _ := json.Marshal(value)
					elements.DashboardElementVisualization.Config[key] = jsontypes.NewNormalizedValue(string(result))
				}
			}
			elements.DashboardElementVisualization.HidePanel = types.BoolPointerValue(elementsItem.DashboardElementVisualization.HidePanel)
			elements.DashboardElementVisualization.HorizontalChart = types.BoolPointerValue(elementsItem.DashboardElementVisualization.HorizontalChart)
			elements.DashboardElementVisualization.ID = types.StringValue(elementsItem.DashboardElementVisualization.ID)
			elements.DashboardElementVisualization.Layout.H = types.Float64Value(elementsItem.DashboardElementVisualization.Layout.H)
			elements.DashboardElementVisualization.Layout.W = types.Float64Value(elementsItem.DashboardElementVisualization.Layout.W)
			elements.DashboardElementVisualization.Layout.X = types.Float64Value(elementsItem.DashboardElementVisualization.Layout.X)
			elements.DashboardElementVisualization.Layout.Y = types.Float64Value(elementsItem.DashboardElementVisualization.Layout.Y)
			if elementsItem.DashboardElementVisualization.Search.SearchQuerySaved != nil {
				elements.DashboardElementVisualization.Search.SearchQuerySaved = &tfTypes.SearchQuerySaved{}
				elements.DashboardElementVisualization.Search.SearchQuerySaved.Query = types.StringPointerValue(elementsItem.DashboardElementVisualization.Search.SearchQuerySaved.Query)
				elements.DashboardElementVisualization.Search.SearchQuerySaved.QueryID = types.StringValue(elementsItem.DashboardElementVisualization.Search.SearchQuerySaved.QueryID)
				if elementsItem.DashboardElementVisualization.Search.SearchQuerySaved.RunMode != nil {
					elements.DashboardElementVisualization.Search.SearchQuerySaved.RunMode = types.StringValue(string(*elementsItem.DashboardElementVisualization.Search.SearchQuerySaved.RunMode))
				} else {
					elements.DashboardElementVisualization.Search.SearchQuerySaved.RunMode = types.StringNull()
				}
				elements.DashboardElementVisualization.Search.SearchQuerySaved.Type = types.StringValue(string(elementsItem.DashboardElementVisualization.Search.SearchQuerySaved.Type))
			}
			if elementsItem.DashboardElementVisualization.Search.SearchQueryInline != nil {
				elements.DashboardElementVisualization.Search.SearchQueryInline = &tfTypes.SearchQueryInline{}
				if elementsItem.DashboardElementVisualization.Search.SearchQueryInline.Earliest != nil {
					elements.DashboardElementVisualization.Search.SearchQueryInline.Earliest = &tfTypes.SearchQueryEarliest{}
					if elementsItem.DashboardElementVisualization.Search.SearchQueryInline.Earliest.Str != nil {
						elements.DashboardElementVisualization.Search.SearchQueryInline.Earliest.Str = types.StringPointerValue(elementsItem.DashboardElementVisualization.Search.SearchQueryInline.Earliest.Str)
					}
					if elementsItem.DashboardElementVisualization.Search.SearchQueryInline.Earliest.Number != nil {
						elements.DashboardElementVisualization.Search.SearchQueryInline.Earliest.Number = types.Float64PointerValue(elementsItem.DashboardElementVisualization.Search.SearchQueryInline.Earliest.Number)
					}
				}
				if elementsItem.DashboardElementVisualization.Search.SearchQueryInline.Latest != nil {
					elements.DashboardElementVisualization.Search.SearchQueryInline.Latest = &tfTypes.SearchQueryLatest{}
					if elementsItem.DashboardElementVisualization.Search.SearchQueryInline.Latest.Str != nil {
						elements.DashboardElementVisualization.Search.SearchQueryInline.Latest.Str = types.StringPointerValue(elementsItem.DashboardElementVisualization.Search.SearchQueryInline.Latest.Str)
					}
					if elementsItem.DashboardElementVisualization.Search.SearchQueryInline.Latest.Number != nil {
						elements.DashboardElementVisualization.Search.SearchQueryInline.Latest.Number = types.Float64PointerValue(elementsItem.DashboardElementVisualization.Search.SearchQueryInline.Latest.Number)
					}
				}
				elements.DashboardElementVisualization.Search.SearchQueryInline.ParentSearchID = types.StringPointerValue(elementsItem.DashboardElementVisualization.Search.SearchQueryInline.ParentSearchID)
				elements.DashboardElementVisualization.Search.SearchQueryInline.Query = types.StringValue(elementsItem.DashboardElementVisualization.Search.SearchQueryInline.Query)
				elements.DashboardElementVisualization.Search.SearchQueryInline.SampleRate = types.Float64PointerValue(elementsItem.DashboardElementVisualization.Search.SearchQueryInline.SampleRate)
				elements.DashboardElementVisualization.Search.SearchQueryInline.Timezone = types.StringPointerValue(elementsItem.DashboardElementVisualization.Search.SearchQueryInline.Timezone)
				elements.DashboardElementVisualization.Search.SearchQueryInline.Type = types.StringValue(string(elementsItem.DashboardElementVisualization.Search.SearchQueryInline.Type))
			}
			if elementsItem.DashboardElementVisualization.Search.SearchQueryValues != nil {
				elements.DashboardElementVisualization.Search.SearchQueryValues = &tfTypes.SearchQueryValues{}
				elements.DashboardElementVisualization.Search.SearchQueryValues.Type = types.StringValue(string(elementsItem.DashboardElementVisualization.Search.SearchQueryValues.Type))
				elements.DashboardElementVisualization.Search.SearchQueryValues.Values = make([]types.String, 0, len(elementsItem.DashboardElementVisualization.Search.SearchQueryValues.Values))
				for _, v := range elementsItem.DashboardElementVisualization.Search.SearchQueryValues.Values {
					elements.DashboardElementVisualization.Search.SearchQueryValues.Values = append(elements.DashboardElementVisualization.Search.SearchQueryValues.Values, types.StringValue(v))
				}
			}
			elements.DashboardElementVisualization.Title = types.StringPointerValue(elementsItem.DashboardElementVisualization.Title)
			if elementsItem.DashboardElementVisualization.TitleAction == nil {
				elements.DashboardElementVisualization.TitleAction = nil
			} else {
				elements.DashboardElementVisualization.TitleAction = &tfTypes.TitleAction{}
				elements.DashboardElementVisualization.TitleAction.Label = types.StringValue(elementsItem.DashboardElementVisualization.TitleAction.Label)
				elements.DashboardElementVisualization.TitleAction.OpenInNewTab = types.BoolPointerValue(elementsItem.DashboardElementVisualization.TitleAction.OpenInNewTab)
				elements.DashboardElementVisualization.TitleAction.URL = types.StringValue(elementsItem.DashboardElementVisualization.TitleAction.URL)
			}
			elements.DashboardElementVisualization.Type = types.StringValue(string(elementsItem.DashboardElementVisualization.Type))
		}
		if elementsItem.DashboardElementInput != nil {
			elements.DashboardElementInput = &tfTypes.DashboardElementInput{}
			if elementsItem.DashboardElementInput.Config == nil {
				elements.DashboardElementInput.Config = nil
			} else {
				elements.DashboardElementInput.Config = &tfTypes.InputElementConfig{}
				if elementsItem.DashboardElementInput.Config.DefaultValue != nil {
					elements.DashboardElementInput.Config.DefaultValue = &tfTypes.DefaultValueUnion{}
					if elementsItem.DashboardElementInput.Config.DefaultValue.Str != nil {
						elements.DashboardElementInput.Config.DefaultValue.Str = types.StringPointerValue(elementsItem.DashboardElementInput.Config.DefaultValue.Str)
					}
					if elementsItem.DashboardElementInput.Config.DefaultValue.Number != nil {
						elements.DashboardElementInput.Config.DefaultValue.Number = types.Float64PointerValue(elementsItem.DashboardElementInput.Config.DefaultValue.Number)
					}
					if elementsItem.DashboardElementInput.Config.DefaultValue.DefaultValue != nil {
						elements.DashboardElementInput.Config.DefaultValue.DefaultValue = &tfTypes.DefaultValue{}
						if elementsItem.DashboardElementInput.Config.DefaultValue.DefaultValue.Earliest.Str != nil {
							elements.DashboardElementInput.Config.DefaultValue.DefaultValue.Earliest.Str = types.StringPointerValue(elementsItem.DashboardElementInput.Config.DefaultValue.DefaultValue.Earliest.Str)
						}
						if elementsItem.DashboardElementInput.Config.DefaultValue.DefaultValue.Earliest.Number != nil {
							elements.DashboardElementInput.Config.DefaultValue.DefaultValue.Earliest.Number = types.Float64PointerValue(elementsItem.DashboardElementInput.Config.DefaultValue.DefaultValue.Earliest.Number)
						}
						if elementsItem.DashboardElementInput.Config.DefaultValue.DefaultValue.Latest.Str != nil {
							elements.DashboardElementInput.Config.DefaultValue.DefaultValue.Latest.Str = types.StringPointerValue(elementsItem.DashboardElementInput.Config.DefaultValue.DefaultValue.Latest.Str)
						}
						if elementsItem.DashboardElementInput.Config.DefaultValue.DefaultValue.Latest.Number != nil {
							elements.DashboardElementInput.Config.DefaultValue.DefaultValue.Latest.Number = types.Float64PointerValue(elementsItem.DashboardElementInput.Config.DefaultValue.DefaultValue.Latest.Number)
						}
						elements.DashboardElementInput.Config.DefaultValue.DefaultValue.Timezone = types.StringPointerValue(elementsItem.DashboardElementInput.Config.DefaultValue.DefaultValue.Timezone)
					}
				}
			}
			elements.DashboardElementInput.HidePanel = types.BoolPointerValue(elementsItem.DashboardElementInput.HidePanel)
			elements.DashboardElementInput.HorizontalChart = types.BoolPointerValue(elementsItem.DashboardElementInput.HorizontalChart)
			elements.DashboardElementInput.ID = types.StringValue(elementsItem.DashboardElementInput.ID)
			elements.DashboardElementInput.InputID = types.StringValue(elementsItem.DashboardElementInput.InputID)
			elements.DashboardElementInput.Layout.H = types.Float64Value(elementsItem.DashboardElementInput.Layout.H)
			elements.DashboardElementInput.Layout.W = types.Float64Value(elementsItem.DashboardElementInput.Layout.W)
			elements.DashboardElementInput.Layout.X = types.Float64Value(elementsItem.DashboardElementInput.Layout.X)
			elements.DashboardElementInput.Layout.Y = types.Float64Value(elementsItem.DashboardElementInput.Layout.Y)
			if elementsItem.DashboardElementInput.Search != nil {
				elements.DashboardElementInput.Search = &tfTypes.SearchQuery{}
				if elementsItem.DashboardElementInput.Search.SearchQuerySaved != nil {
					elements.DashboardElementInput.Search.SearchQuerySaved = &tfTypes.SearchQuerySaved{}
					elements.DashboardElementInput.Search.SearchQuerySaved.Query = types.StringPointerValue(elementsItem.DashboardElementInput.Search.SearchQuerySaved.Query)
					elements.DashboardElementInput.Search.SearchQuerySaved.QueryID = types.StringValue(elementsItem.DashboardElementInput.Search.SearchQuerySaved.QueryID)
					if elementsItem.DashboardElementInput.Search.SearchQuerySaved.RunMode != nil {
						elements.DashboardElementInput.Search.SearchQuerySaved.RunMode = types.StringValue(string(*elementsItem.DashboardElementInput.Search.SearchQuerySaved.RunMode))
					} else {
						elements.DashboardElementInput.Search.SearchQuerySaved.RunMode = types.StringNull()
					}
					elements.DashboardElementInput.Search.SearchQuerySaved.Type = types.StringValue(string(elementsItem.DashboardElementInput.Search.SearchQuerySaved.Type))
				}
				if elementsItem.DashboardElementInput.Search.SearchQueryInline != nil {
					elements.DashboardElementInput.Search.SearchQueryInline = &tfTypes.SearchQueryInline{}
					if elementsItem.DashboardElementInput.Search.SearchQueryInline.Earliest != nil {
						elements.DashboardElementInput.Search.SearchQueryInline.Earliest = &tfTypes.SearchQueryEarliest{}
						if elementsItem.DashboardElementInput.Search.SearchQueryInline.Earliest.Str != nil {
							elements.DashboardElementInput.Search.SearchQueryInline.Earliest.Str = types.StringPointerValue(elementsItem.DashboardElementInput.Search.SearchQueryInline.Earliest.Str)
						}
						if elementsItem.DashboardElementInput.Search.SearchQueryInline.Earliest.Number != nil {
							elements.DashboardElementInput.Search.SearchQueryInline.Earliest.Number = types.Float64PointerValue(elementsItem.DashboardElementInput.Search.SearchQueryInline.Earliest.Number)
						}
					}
					if elementsItem.DashboardElementInput.Search.SearchQueryInline.Latest != nil {
						elements.DashboardElementInput.Search.SearchQueryInline.Latest = &tfTypes.SearchQueryLatest{}
						if elementsItem.DashboardElementInput.Search.SearchQueryInline.Latest.Str != nil {
							elements.DashboardElementInput.Search.SearchQueryInline.Latest.Str = types.StringPointerValue(elementsItem.DashboardElementInput.Search.SearchQueryInline.Latest.Str)
						}
						if elementsItem.DashboardElementInput.Search.SearchQueryInline.Latest.Number != nil {
							elements.DashboardElementInput.Search.SearchQueryInline.Latest.Number = types.Float64PointerValue(elementsItem.DashboardElementInput.Search.SearchQueryInline.Latest.Number)
						}
					}
					elements.DashboardElementInput.Search.SearchQueryInline.ParentSearchID = types.StringPointerValue(elementsItem.DashboardElementInput.Search.SearchQueryInline.ParentSearchID)
					elements.DashboardElementInput.Search.SearchQueryInline.Query = types.StringValue(elementsItem.DashboardElementInput.Search.SearchQueryInline.Query)
					elements.DashboardElementInput.Search.SearchQueryInline.SampleRate = types.Float64PointerValue(elementsItem.DashboardElementInput.Search.SearchQueryInline.SampleRate)
					elements.DashboardElementInput.Search.SearchQueryInline.Timezone = types.StringPointerValue(elementsItem.DashboardElementInput.Search.SearchQueryInline.Timezone)
					elements.DashboardElementInput.Search.SearchQueryInline.Type = types.StringValue(string(elementsItem.DashboardElementInput.Search.SearchQueryInline.Type))
				}
				if elementsItem.DashboardElementInput.Search.SearchQueryValues != nil {
					elements.DashboardElementInput.Search.SearchQueryValues = &tfTypes.SearchQueryValues{}
					elements.DashboardElementInput.Search.SearchQueryValues.Type = types.StringValue(string(elementsItem.DashboardElementInput.Search.SearchQueryValues.Type))
					elements.DashboardElementInput.Search.SearchQueryValues.Values = make([]types.String, 0, len(elementsItem.DashboardElementInput.Search.SearchQueryValues.Values))
					for _, v := range elementsItem.DashboardElementInput.Search.SearchQueryValues.Values {
						elements.DashboardElementInput.Search.SearchQueryValues.Values = append(elements.DashboardElementInput.Search.SearchQueryValues.Values, types.StringValue(v))
					}
				}
			}
			elements.DashboardElementInput.Title = types.StringPointerValue(elementsItem.DashboardElementInput.Title)
			if elementsItem.DashboardElementInput.TitleAction == nil {
				elements.DashboardElementInput.TitleAction = nil
			} else {
				elements.DashboardElementInput.TitleAction = &tfTypes.TitleAction{}
				elements.DashboardElementInput.TitleAction.Label = types.StringValue(elementsItem.DashboardElementInput.TitleAction.Label)
				elements.DashboardElementInput.TitleAction.OpenInNewTab = types.BoolPointerValue(elementsItem.DashboardElementInput.TitleAction.OpenInNewTab)
				elements.DashboardElementInput.TitleAction.URL = types.StringValue(elementsItem.DashboardElementInput.TitleAction.URL)
			}
			elements.DashboardElementInput.Type = types.StringValue(string(elementsItem.DashboardElementInput.Type))
		}
		if elementsItem.DashboardElement != nil {
			elements.DashboardElement = &tfTypes.DashboardElement{}
			if elementsItem.DashboardElement.Config == nil {
				elements.DashboardElement.Config = nil
			} else {
				elements.DashboardElement.Config = &tfTypes.MarkdownElementConfig{}
				elements.DashboardElement.Config.Markdown = types.StringValue(elementsItem.DashboardElement.Config.Markdown)
			}
			elements.DashboardElement.HidePanel = types.BoolPointerValue(elementsItem.DashboardElement.HidePanel)
			elements.DashboardElement.HorizontalChart = types.BoolPointerValue(elementsItem.DashboardElement.HorizontalChart)
			elements.DashboardElement.ID = types.StringValue(elementsItem.DashboardElement.ID)
			elements.DashboardElement.Layout.H = types.Float64Value(elementsItem.DashboardElement.Layout.H)
			elements.DashboardElement.Layout.W = types.Float64Value(elementsItem.DashboardElement.Layout.W)
			elements.DashboardElement.Layout.X = types.Float64Value(elementsItem.DashboardElement.Layout.X)
			elements.DashboardElement.Layout.Y = types.Float64Value(elementsItem.DashboardElement.Layout.Y)
			if elementsItem.DashboardElement.Search == nil {
				elements.DashboardElement.Search = nil
			} else {
				elements.DashboardElement.Search = &tfTypes.PanelQueryDefinition{}
				elements.DashboardElement.Search.Alias = types.StringPointerValue(elementsItem.DashboardElement.Search.Alias)
				elements.DashboardElement.Search.LocalID = types.StringValue(elementsItem.DashboardElement.Search.LocalID)
				elements.DashboardElement.Search.Query = types.StringValue(elementsItem.DashboardElement.Search.Query)
			}
			if elementsItem.DashboardElement.TitleAction == nil {
				elements.DashboardElement.TitleAction = nil
			} else {
				elements.DashboardElement.TitleAction = &tfTypes.TitleAction{}
				elements.DashboardElement.TitleAction.Label = types.StringValue(elementsItem.DashboardElement.TitleAction.Label)
				elements.DashboardElement.TitleAction.OpenInNewTab = types.BoolPointerValue(elementsItem.DashboardElement.TitleAction.OpenInNewTab)
				elements.DashboardElement.TitleAction.URL = types.StringValue(elementsItem.DashboardElement.TitleAction.URL)
			}
			elements.DashboardElement.Type = types.StringValue(string(elementsItem.DashboardElement.Type))
			elements.DashboardElement.Variant = types.StringValue(string(elementsItem.DashboardElement.Variant))
		}

		r.Elements = append(r.Elements, elements)
	}
	if len(resp.Groups) > 0 {
		r.Groups = make(map[string]tfTypes.DashboardGroups, len(resp.Groups))
		for dashboardGroupsKey, dashboardGroupsValue := range resp.Groups {
			var dashboardGroupsResult tfTypes.DashboardGroups
			if dashboardGroupsValue.Action == nil {
				dashboardGroupsResult.Action = nil
			} else {
				dashboardGroupsResult.Action = &tfTypes.DashboardGroupsAction{}
				dashboardGroupsResult.Action.Label = types.StringValue(dashboardGroupsValue.Action.Label)
				if len(dashboardGroupsValue.Action.Params) > 0 {
					dashboardGroupsResult.Action.Params = make(map[string]types.String, len(dashboardGroupsValue.Action.Params))
					for key1, value1 := range dashboardGroupsValue.Action.Params {
						dashboardGroupsResult.Action.Params[key1] = types.StringValue(value1)
					}
				}
				dashboardGroupsResult.Action.Target = types.StringValue(dashboardGroupsValue.Action.Target)
			}
			dashboardGroupsResult.Collapsed = types.BoolPointerValue(dashboardGroupsValue.Collapsed)
			dashboardGroupsResult.InputID = types.StringPointerValue(dashboardGroupsValue.InputID)
			dashboardGroupsResult.Title = types.StringValue(dashboardGroupsValue.Title)

			r.Groups[dashboardGroupsKey] = dashboardGroupsResult
		}
	}
	r.ID = types.StringValue(resp.ID)
	r.Name = types.StringValue(resp.Name)
	r.RefreshRate = types.Float64PointerValue(resp.RefreshRate)
	if resp.Schedule == nil {
		r.Schedule = nil
	} else {
		r.Schedule = &tfTypes.SavedQuerySchedule{}
		r.Schedule.CronSchedule = types.StringValue(resp.Schedule.CronSchedule)
		r.Schedule.Enabled = types.BoolValue(resp.Schedule.Enabled)
		r.Schedule.KeepLastN = types.Float64Value(resp.Schedule.KeepLastN)
		r.Schedule.Notifications.Disabled = types.BoolValue(resp.Schedule.Notifications.Disabled)
		r.Schedule.Tz = types.StringValue(resp.Schedule.Tz)
	}

	return diags
}

func (r *SearchDashboardDataSourceModel) ToOperationsGetSearchDashboardByIDRequest(ctx context.Context) (*operations.GetSearchDashboardByIDRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	var id string
	id = r.ID.ValueString()

	out := operations.GetSearchDashboardByIDRequest{
		ID: id,
	}

	return &out, diags
}
